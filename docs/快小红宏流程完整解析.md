# å¿«å°çº¢ - MacroDroidå®æµç¨‹å®Œæ•´è§£æ

**æ–‡æ¡£æ—¥æœŸ**: 2026-01-08
**åˆ†ææ¥æº**: kxh.txt MacroDroidé…ç½®æ–‡ä»¶
**ç›®æ ‡**: è¯„ä¼°é¸¿è’™è‡ªåŠ¨åŒ–å®Appçš„åŠŸèƒ½æ”¯æŒåº¦

---

## ğŸ“‹ ä¸€ã€å˜é‡å®šä¹‰ï¼ˆ26ä¸ªæœ¬åœ°å˜é‡ï¼‰

### å¿…å¡«é…ç½®å˜é‡

| å˜é‡å | ç±»å‹ | æ˜¯å¦åŠ å¯† | è¯´æ˜ |
|--------|------|---------|------|
| `è®¢å•å·` | String | âœ… | ç”¨æˆ·è®¢å•æ ‡è¯†ï¼ˆP1234567890ï¼‰ |
| `é£ä¹¦å¤šç»´è¡¨æ ¼æˆæƒç ` | String | âœ… | API Bearer Token |
| `é‡‡é›†åº“è¡¨é“¾æ¥` | String | âœ… | é£ä¹¦å¤šç»´è¡¨æ ¼URLï¼ˆç¬”è®°é‡‡é›†åº“ï¼‰ |
| `å°çº¢ä¹¦å•†å“ç›‘æµ‹è¡¨é“¾æ¥` | String | âœ… | é£ä¹¦å¤šç»´è¡¨æ ¼URLï¼ˆå•†å“åº“ï¼‰ |
| `å°çº¢ä¹¦åšä¸»åº“è¡¨é“¾æ¥` | String | âœ… | é£ä¹¦å¤šç»´è¡¨æ ¼URLï¼ˆåšä¸»åº“ï¼‰ |
| `cookie` | String | âœ… | å°çº¢ä¹¦è´¦å·Cookieï¼ˆé€‰å¡«ï¼Œç”¨äºè·å–äº’åŠ¨æ•°æ®ï¼‰ |

### è¿è¡Œæ—¶å˜é‡

| å˜é‡å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `å‰ªè´´æ¿å†…å®¹` | String | ç¤ºä¾‹æ–‡æœ¬ | ç”¨æˆ·å¤åˆ¶çš„åŸå§‹å†…å®¹ |
| `url` | String | - | æ­£åˆ™æå–çš„URLé“¾æ¥ |
| `çˆ†æ¬¾æ ‡è®°` | String | "âšª æ™®é€šæ¬¾" | ç”¨æˆ·é€‰æ‹©çš„çˆ†æ¬¾çº§åˆ« |
| `çˆ†æ¬¾æ ‡è®°æ•°ç»„` | Array | 3ä¸ªé€‰é¡¹ | ["âšª æ™®é€šæ¬¾", "ğŸŸ¡ æ½œåŠ›æ¬¾", "ğŸ”´ å¤§çˆ†æ¬¾"] |
| `åˆ†ç±»æ ‡ç­¾` | String | - | ç”¨æˆ·é€‰æ‹©çš„å†…å®¹åˆ†ç±» |
| `åˆ†ç±»æ ‡ç­¾æ•°ç»„` | Array | 40ä¸ªé€‰é¡¹ | ğŸ’„æ—¶å°šç¾å¦†ã€ğŸŒæ—…æ¸¸å‡ºè¡Œã€ğŸ“šå­¦ä¹ æ•™è‚²ç­‰ |
| `quality` | Number | 0 | å¯¹æ ‡å‚è€ƒåº¦ï¼ˆ1-5èµï¼‰ |
| `qualityå­—ç¬¦ä¸²` | String | - | å¯¹è¯æ¡†æ˜¾ç¤ºçš„è¯„åˆ†æ–‡æœ¬ |
| `å¤‡æ³¨è¯´æ˜` | String | - | ç”¨æˆ·è‡ªå®šä¹‰å¤‡æ³¨ |
| `labelç´¢å¼•` | Number | - | é€‰æ‹©çš„åˆ†ç±»æ ‡ç­¾ç´¢å¼• |
| `readç´¢å¼•` | Number | - | é€‰æ‹©çš„çˆ†æ¬¾æ ‡è®°ç´¢å¼• |
| `app_token` | String | - | ä»è¡¨æ ¼é“¾æ¥è§£æçš„åº”ç”¨Token |
| `table_id` | String | - | ä»è¡¨æ ¼é“¾æ¥è§£æçš„è¡¨æ ¼ID |
| `é‡‡é›†åº“å­—æ®µå†…å®¹` | String | - | é£ä¹¦APIè¿”å›çš„è¡¨æ ¼å­—æ®µå…ƒæ•°æ® |
| `è®°å½•æ·»åŠ å“åº”ä½“` | String | - | ç¬”è®°é‡‡é›†APIè¿”å›çš„å®Œæ•´å“åº” |
| `é‡‡é›†å•†å“å“åº”ä½“` | String | - | å•†å“é‡‡é›†APIè¿”å›çš„å®Œæ•´å“åº” |
| `é‡‡é›†åšä¸»ä¿¡æ¯å“åº”ä½“` | String | - | åšä¸»é‡‡é›†APIè¿”å›çš„å®Œæ•´å“åº” |
| `è¿”å›çš„å•ç¯‡æç¤ºè¯­` | String | - | ä»å“åº”ä¸­æå–çš„æç¤ºä¿¡æ¯ |
| `è¿”å›çš„å•†å“æç¤ºè¯­` | String | - | å•†å“é‡‡é›†æç¤ºä¿¡æ¯ |
| `è¿”å›çš„åšä¸»ä¿¡æ¯æç¤ºè¯­` | String | - | åšä¸»é‡‡é›†æç¤ºä¿¡æ¯ |
| `xhsmå»å‘` | String | - | ç§»åŠ¨ç«¯é“¾æ¥çš„ç”¨æˆ·é€‰æ‹©ï¼ˆåšä¸»/å•†å“ï¼‰ |
| `å­—å…¸ä¸Šä¼ ` | Dictionary | - | ç”¨äºæ„å»ºJSONè¯·æ±‚ä½“çš„å­—å…¸å¯¹è±¡ |
| `å­—å…¸æ•°ç»„label` | Array | - | å°†labelå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°ç»„ |
| `ä¸Šä¼ æµ` | String | - | å­—å…¸è½¬æ¢åçš„JSONå­—ç¬¦ä¸² |

### å›ºå®šé…ç½®å˜é‡

| å˜é‡å | å€¼ | è¯´æ˜ |
|--------|---|------|
| `flownote` | 7550495126771449906 | é£ä¹¦æ‰£å­ç¬”è®°é‡‡é›†å·¥ä½œæµID |
| `flowgoods` | 7550495655455375396 | é£ä¹¦æ‰£å­å•†å“é‡‡é›†å·¥ä½œæµID |
| `flowbozhu` | 7550495802553106467 | é£ä¹¦æ‰£å­åšä¸»é‡‡é›†å·¥ä½œæµID |
| `è¡¨æ ¼æ ¸å¯¹ç ` | sat_NbvH6WQTg8EX... | é£ä¹¦APIé‰´æƒToken |
| `æµç¨‹èŠ‚ç‚¹è®¾ç½®` | å¤šè¡Œæ–‡æœ¬ | æ§åˆ¶å“ªäº›æ­¥éª¤å¼€å¯/å…³é—­ |

---

## ğŸ”„ äºŒã€å®Œæ•´æµç¨‹æ­¥éª¤

### é˜¶æ®µ1: å¯åŠ¨ä¸éªŒè¯ï¼ˆæ­¥éª¤1-3ï¼‰

```
1ï¸âƒ£ å¯åŠ¨MacroDroidåº”ç”¨
   åŠ¨ä½œ: LaunchActivityAction
   å‚æ•°: packageName="MacroDroid", excludeFromRecents=false

2ï¸âƒ£ æ˜¾ç¤ºå¯åŠ¨æç¤º
   åŠ¨ä½œ: ToastAction
   å‚æ•°: message="å¼€å§‹é‡‡é›†ï¼Œè¯·æŒ‰æç¤ºé€æ­¥æ“ä½œ", duration=1ç§’

3ï¸âƒ£ æ˜¾ç¤ºåŠ¨ç”»æ•ˆæœ
   åŠ¨ä½œ: AnimationOverlayAction
   å‚æ•°: animationId="RAINBOW", height=0.31, width=0.43, duration=æŒç»­æ˜¾ç¤º
```

#### é…ç½®éªŒè¯é€»è¾‘

```typescript
IF (è®¢å•å· == "" OR
    é£ä¹¦å¤šç»´è¡¨æ ¼æˆæƒç  == "" OR
    é‡‡é›†åº“è¡¨é“¾æ¥ == "" OR
    å°çº¢ä¹¦å•†å“ç›‘æµ‹è¡¨é“¾æ¥ == "" OR
    å°çº¢ä¹¦åšä¸»åº“è¡¨é“¾æ¥ == "" OR
    cookie == "")
THEN
    æ˜¾ç¤ºMessageDialog:
        title: "âš ï¸ æ‚¨è¿˜æœªè¿›è¡Œåˆå§‹é…ç½®"
        message: "è¯·æ£€æŸ¥MacroDroidé‡Œ"å¿«å°çº¢"é‡Œçš„å˜é‡æ˜¯å¦éƒ½å·²å¡«å†™å€¼å¹¶å¡«å†™æ­£ç¡®ï¼"
        buttons: ["ç¡®å®š", "å–æ¶ˆ"]

    é€€å‡ºå® (CancelActiveMacroAction)
END IF
```

---

### é˜¶æ®µ2: è¯»å–å‰ªè´´æ¿ï¼ˆæ­¥éª¤4-6ï¼‰

```typescript
4ï¸âƒ£ æ›´æ–°ç³»ç»Ÿå‰ªè´´æ¿
   åŠ¨ä½œ: UpdateClipboardAction

5ï¸âƒ£ è¯»å–å‰ªè´´æ¿å†…å®¹
   åŠ¨ä½œ: SetVariableAction
   å‚æ•°:
     variable: "å‰ªè´´æ¿å†…å®¹"
     value: "{clipboard}"  // ç³»ç»Ÿå˜é‡

6ï¸âƒ£ æ­£åˆ™æå–URL
   åŠ¨ä½œ: TextManipulationAction
   å‚æ•°:
     operation: "ExtractText"
     pattern: "https?://[^\\s]+"
     groupIndex: 0
     saveToVariable: "url"

// éªŒè¯é€»è¾‘
IF (å‰ªè´´æ¿å†…å®¹ NOT CONTAINS "http") THEN
    æ˜¾ç¤ºMessageDialog:
        title: "âš ï¸ æ‚¨æœªå¤åˆ¶é“¾æ¥"
        message: "æ‚¨è¿˜æœªå¤åˆ¶é‡‡é›†å†…å®¹çš„é“¾æ¥ï¼è¯·å¤åˆ¶é“¾æ¥åå†è¿è¡Œå¿«æ·æŒ‡ä»¤ã€‚"

    é€€å‡ºå®
END IF
```

---

### é˜¶æ®µ3: åˆå§‹åŒ–ä¸åˆ†æµï¼ˆæ­¥éª¤7-9ï¼‰

```typescript
7ï¸âƒ£ æ¸…ç©ºä¸´æ—¶å˜é‡
   åŠ¨ä½œ: ClearVariablesAction
   æ¸…ç©º: ["å¤‡æ³¨è¯´æ˜", "é‡‡é›†åšä¸»ä¿¡æ¯å“åº”ä½“", "é‡‡é›†åº“å­—æ®µå†…å®¹",
         "é‡‡é›†å•†å“å“åº”ä½“", "è®°å½•æ·»åŠ å“åº”ä½“", "å­—å…¸ä¸Šä¼ ",
         "label", "quality", "read", "xhsmå»å‘"]

8ï¸âƒ£ è®¾ç½®é»˜è®¤å€¼
   quality = "0"
   flownote = "7550495126771449906"
   flowgoods = "7550495655455375396"
   flowbozhu = "7550495802553106467"
   è¡¨æ ¼æ ¸å¯¹ç  = "sat_NbvH6WQTg8EX496ohv6JE0B3ocRAnTuWKYyt4ADuajYzs6RQdwW4emf5GmjQdfwe"
```

#### å†…å®¹ç±»å‹åˆ¤æ–­

```typescript
9ï¸âƒ£ IF (url CONTAINS "xhslink.com/m") THEN
    // ç§»åŠ¨ç«¯çŸ­é“¾æ¥ï¼Œå¼¹å‡ºé€‰æ‹©å¯¹è¯æ¡†
    æ˜¾ç¤ºSelectionDialog:
        title: "ğŸ‘‰ æ‚¨è¦é‡‡é›†ä»€ä¹ˆä¿¡æ¯å‘¢ï¼Ÿ"
        options: [
            "ğŸ‘©â€ğŸ’»åšä¸»ä¿¡æ¯",
            "ğŸ›’å•†å“ä¿¡æ¯"
        ]
        saveValueTo: "xhsmå»å‘"
        saveIndexTo: "xhsmå»å‘ç´¢å¼•"
END IF
```

---

### åˆ†æ”¯A: é‡‡é›†å•†å“ä¿¡æ¯ï¼ˆæ­¥éª¤10-15ï¼‰

```typescript
è§¦å‘æ¡ä»¶:
IF (url CONTAINS "xiaohongshu.com/goods-detail" OR
    xhsmå»å‘ == "ğŸ›’å•†å“ä¿¡æ¯") THEN

ğŸ”Ÿ æ˜¾ç¤ºè¿›åº¦æç¤º
   Toast: "æ•°æ®ä¸Šä¼ ä¸­ï¼Œè¯·è€å¿ƒç­‰å¾…"

1ï¸âƒ£1ï¸âƒ£ æ˜¾ç¤ºåŠ¨ç”»
   AnimationOverlay: duration=12ç§’

1ï¸âƒ£2ï¸âƒ£ å‘é€HTTPè¯·æ±‚é‡‡é›†å•†å“
   åŠ¨ä½œ: HttpRequestAction
   é…ç½®:
     method: POST
     url: "https://api.coze.cn/v1/workflow/run"
     headers: {
         "Authorization": "Bearer {è¡¨æ ¼æ ¸å¯¹ç }"
     }
     contentType: "application/json"
     body: {
         "workflow_id": "{flowgoods}",
         "parameters": {
             "basetoken": "{é£ä¹¦å¤šç»´è¡¨æ ¼æˆæƒç }",
             "knowledgeurl": "{å°çº¢ä¹¦å•†å“ç›‘æµ‹è¡¨é“¾æ¥}",
             "ordeid": "{è®¢å•å·}",
             "url": "{url}",
             "xhscookie": "{cookie}"
         }
     }
     timeout: 40ç§’
     saveResponseTo: "é‡‡é›†å•†å“å“åº”ä½“"

1ï¸âƒ£3ï¸âƒ£ è§£æå“åº”
   // å»é™¤JSONç¬¦å·
   TextManipulation:
     operation: "RemoveText"
     pattern: "[{}\"\\\\]"
     saveToVariable: "é‡‡é›†å•†å“å“åº”ä½“å»æ‰ç¬¦å·"

   // æå–æç¤ºè¯­
   TextManipulation:
     operation: "ExtractText"
     pattern: "prompt:([\\s\\S]*?)(?=,\\w+:|$)"
     groupIndex: 1
     saveToVariable: "è¿”å›çš„å•†å“æç¤ºè¯­"

1ï¸âƒ£4ï¸âƒ£ é”™è¯¯å¤„ç†
   IF (é‡‡é›†å•†å“å“åº”ä½“å»æ‰ç¬¦å· NOT CONTAINS "code:0") THEN
       æ˜¾ç¤ºOptionDialog:
           title: "âš ï¸ é‡‡é›†å¤±è´¥"
           message: "ä¸å¥½æ„æ€ï¼Œä¸é£ä¹¦å¯¹æ¥å‡ºäº†ç‚¹å¼‚å¸¸ï¼Œè¯·æ‚¨é‡æ–°æ“ä½œä¸€éã€‚å¦‚è¿˜æ˜¯å¤±è´¥ï¼Œæ‚¨å¯ä»¥è”ç³»å®¢æœè§£å†³ï¼"
           buttons: ["ç¡®å®š", "å–æ¶ˆ", "è”ç³»å®¢æœ"]

       IF é€‰æ‹©"è”ç³»å®¢æœ" THEN
           æ‰“å¼€URL: "https://lv13e2iljbk.feishu.cn/docx/Og5ddVoAboc9Wox6mmkcIuA7nlc?from=from_copylink"
       END IF

       é€€å‡ºå®
   END IF

   IF (é‡‡é›†å•†å“å“åº”ä½“å»æ‰ç¬¦å· CONTAINS "add_result:false") THEN
       æ˜¾ç¤ºOptionDialog:
           title: "âš ï¸ é‡‡é›†å¤±è´¥"
           message: "{è¿”å›çš„å•†å“æç¤ºè¯­}"
           // å¸¸è§é”™è¯¯ï¼š
           // - "æ‚¨çš„æ‰‹æœºé‡‡é›†æ¬¡æ•°å·²è¾¾é™é¢ï¼"
           // - "é‡‡é›†é™é¢ä¸ºï¼š1 æ¬¡/æ—¥ï¼Œé‡‡é›†åŒ…ä½™é‡ä¸ºï¼š0 æ¬¡"

       é€€å‡ºå®
   END IF

1ï¸âƒ£5ï¸âƒ£ æˆåŠŸå¤„ç†
   IF (é‡‡é›†å•†å“å“åº”ä½“å»æ‰ç¬¦å· CONTAINS "add_result:true") THEN
       æ˜¾ç¤ºOptionDialog:
           title: "âœ… é‡‡é›†æˆåŠŸ"
           message: "{è¿”å›çš„å•†å“æç¤ºè¯­}"
           buttons: ["ç¡®å®š", "å–æ¶ˆ", "æ‰“å¼€é£ä¹¦"]

       IF é€‰æ‹©"æ‰“å¼€é£ä¹¦" THEN
           æ‰“å¼€URL: "https://applink.feishu.cn/client/docs/open?url={å°çº¢ä¹¦å•†å“ç›‘æµ‹è¡¨é“¾æ¥}"
       END IF

       é€€å‡ºå®
   END IF

END IF
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "code": 0,
  "msg": "success",
  "data": "{\"add_result\":true,\"prompt\":\"å·²é‡‡é›†å•†å“ã€Šæ— çº¿è“ç‰™è€³æœºã€‹å»å¤šç»´è¡¨æ ¼çœ‹çœ‹å§ï¼\",\"title\":\"æ— çº¿è“ç‰™è€³æœº\"}",
  "debug_url": "https://www.coze.cn/work_flow?execute_id=xxx"
}
```

---

### åˆ†æ”¯B: é‡‡é›†åšä¸»ä¿¡æ¯ï¼ˆæ­¥éª¤16-20ï¼‰

```typescript
è§¦å‘æ¡ä»¶:
IF (url CONTAINS "xiaohongshu.com/user" OR
    xhsmå»å‘ == "ğŸ‘©â€ğŸ’»åšä¸»ä¿¡æ¯") THEN

1ï¸âƒ£6ï¸âƒ£ æ˜¾ç¤ºè¿›åº¦æç¤º
   Toast: "æ•°æ®ä¸Šä¼ ä¸­ï¼Œè¯·è€å¿ƒç­‰å¾…"

1ï¸âƒ£7ï¸âƒ£ æ˜¾ç¤ºåŠ¨ç”»
   AnimationOverlay: duration=12ç§’

1ï¸âƒ£8ï¸âƒ£ å‘é€HTTPè¯·æ±‚é‡‡é›†åšä¸»
   åŠ¨ä½œ: HttpRequestAction
   é…ç½®:
     method: POST
     url: "https://api.coze.cn/v1/workflow/run"
     headers: {
         "Authorization": "Bearer {è¡¨æ ¼æ ¸å¯¹ç }"
     }
     contentType: "application/json"
     body: {
         "workflow_id": "{flowbozhu}",
         "parameters": {
             "basetoken": "{é£ä¹¦å¤šç»´è¡¨æ ¼æˆæƒç }",
             "bloggerurl": "{å°çº¢ä¹¦åšä¸»åº“è¡¨é“¾æ¥}",
             "ordeid": "{è®¢å•å·}",
             "url": "{url}",
             "cookie": "{cookie}"
         }
     }
     timeout: 60ç§’
     saveResponseTo: "é‡‡é›†åšä¸»ä¿¡æ¯å“åº”ä½“"

1ï¸âƒ£9ï¸âƒ£ è§£æä¸é”™è¯¯å¤„ç†ï¼ˆåŒå•†å“æµç¨‹ï¼‰

2ï¸âƒ£0ï¸âƒ£ æˆåŠŸå¤„ç†
   æ˜¾ç¤ºOptionDialog:
       title: "âœ… é‡‡é›†æˆåŠŸ"
       message: "å·²é‡‡é›†åšä¸»ã€Š{åšä¸»åç§°}ã€‹å»å¤šç»´è¡¨æ ¼çœ‹çœ‹å§ï¼"
       buttons: ["ç¡®å®š", "å–æ¶ˆ", "æ‰“å¼€é£ä¹¦"]

   IF é€‰æ‹©"æ‰“å¼€é£ä¹¦" THEN
       æ‰“å¼€URL: "https://applink.feishu.cn/client/docs/open?url={å°çº¢ä¹¦åšä¸»åº“è¡¨é“¾æ¥}"
   END IF

   é€€å‡ºå®

END IF
```

---

### åˆ†æ”¯C: é‡‡é›†ç¬”è®°ï¼ˆå•ç¯‡å†…å®¹ï¼‰â­æ ¸å¿ƒæµç¨‹

#### C1: è·å–è¡¨æ ¼å­—æ®µå…ƒæ•°æ®ï¼ˆæ­¥éª¤21-22ï¼‰

```typescript
2ï¸âƒ£1ï¸âƒ£ è§£æè¡¨æ ¼å‚æ•°
   // æå–app_token
   TextManipulation:
     pattern: "base/([^?]+)"
     input: "{é‡‡é›†åº“è¡¨é“¾æ¥}"
     saveToVariable: "app_token"

   // æå–table_id
   TextManipulation:
     pattern: "table=([^&]+)"
     input: "{é‡‡é›†åº“è¡¨é“¾æ¥}"
     saveToVariable: "table_id"

2ï¸âƒ£2ï¸âƒ£ è·å–è¡¨æ ¼å­—æ®µå®šä¹‰
   åŠ¨ä½œ: HttpRequestAction
   é…ç½®:
     method: GET
     url: "https://base-api.feishu.cn/open-apis/bitable/v1/apps/{app_token}/tables/{table_id}/fields"
     headers: {
         "Authorization": "Bearer {é£ä¹¦å¤šç»´è¡¨æ ¼æˆæƒç }"
     }
     timeout: 60ç§’
     followRedirects: true
     saveResponseTo: "é‡‡é›†åº“å­—æ®µå†…å®¹"
```

**è¿”å›çš„è¡¨æ ¼å­—æ®µç¤ºä¾‹:**
```json
{
  "code": 0,
  "data": {
    "items": [
      {
        "field_id": "fldJHkCVya",
        "field_name": "æ ‡é¢˜",
        "type": 1,
        "is_primary": true
      },
      {
        "field_id": "fldKm1z9ye",
        "field_name": "åˆ†ç±»æ ‡ç­¾",
        "type": 4,
        "property": {
          "options": [
            {"id": "opt7xp0icW", "name": "ğŸ’„æ—¶å°šç¾å¦†", "color": 10},
            {"id": "optnTJKcFK", "name": "ğŸŒæ—…æ¸¸å‡ºè¡Œ", "color": 10},
            {"id": "optRrJhYZM", "name": "ğŸ“šå­¦ä¹ æ•™è‚²", "color": 10}
            // ...å…±40ä¸ªé€‰é¡¹
          ]
        }
      },
      {
        "field_id": "fldwVpFaBw",
        "field_name": "çˆ†æ¬¾",
        "type": 3,
        "property": {
          "options": [
            {"id": "optukZnLJo", "name": "âšª æ™®é€šæ¬¾", "color": 10},
            {"id": "opt7Nj9pPv", "name": "ğŸŸ¡ æ½œåŠ›æ¬¾", "color": 3},
            {"id": "optghA0BXs", "name": "ğŸ”´ å¤§çˆ†æ¬¾", "color": 11}
          ]
        }
      }
    ]
  }
}
```

#### C2: ç”¨æˆ·äº¤äº’é˜¶æ®µï¼ˆæ­¥éª¤23-26ï¼‰

**æµç¨‹èŠ‚ç‚¹å¼€å…³è®¾ç½®:**
```typescript
æµç¨‹èŠ‚ç‚¹è®¾ç½® = "
é€‰æ‹©ã€Œçˆ†æ¬¾æ ‡è®°ã€= å¼€
é€‰æ‹©ã€Œåˆ†ç±»æ ‡ç­¾ã€= å¼€
é€‰æ‹©ã€Œå¯¹æ ‡å‚è€ƒã€= å¼€
å¡«å†™ã€Œå¤‡æ³¨è¯´æ˜ã€= å¼€
æ‰“å¼€ã€Œé‡‡é›†åº“ã€= å¼€
"
// ç”¨æˆ·å¯ä»¥ä¿®æ”¹"å¼€"ä¸º"å…³"æ¥è·³è¿‡æŸäº›æ­¥éª¤
```

```typescript
2ï¸âƒ£3ï¸âƒ£ çˆ†æ¬¾æ ‡è®°é€‰æ‹©
   IF (æµç¨‹èŠ‚ç‚¹è®¾ç½® CONTAINS "é€‰æ‹©ã€Œçˆ†æ¬¾æ ‡è®°ã€= å¼€") THEN

       // æå–çˆ†æ¬¾å­—æ®µé€‰é¡¹
       TextManipulation:
         operation: "ExtractText"
         pattern: "\"field_name\":\"çˆ†æ¬¾\".*?\"options\":\[[\s\S]*?\]"
         saveToVariable: "çˆ†æ¬¾æ ‡è®°å¯¹è±¡å­—ç¬¦ä¸²"

       TextManipulation:
         operation: "ExtractText"
         pattern: "\"name\":\"([^\"]+)\""
         groupIndex: 2  // è·å–æ‰€æœ‰åŒ¹é…
         saveToVariable: "çˆ†æ¬¾æ ‡è®°é€‰é¡¹å­—ç¬¦ä¸²"

       TextManipulation:
         operation: "ReplaceAll"
         pattern: "\"name\":\"([^\"]+)\""
         replacement: "$1\n"
         saveToVariable: "çˆ†æ¬¾æ ‡è®°é€‰é¡¹å€¼"

       TextManipulation:
         operation: "Split"
         delimiter: "\n"
         saveToVariable: "çˆ†æ¬¾æ ‡è®°æ•°ç»„"

       // æ˜¾ç¤ºé€‰æ‹©å¯¹è¯æ¡†
       æ˜¾ç¤ºSelectionDialog:
           title: "ğŸ”¥ è¯·æ ‡è®°å†…å®¹ç«çˆ†ç¨‹åº¦"
           optionsFromVariable: "çˆ†æ¬¾æ ‡è®°æ•°ç»„"
           backgroundColor: -328966  // æ·±è“è‰²
           textColor: -14540254      // ç™½è‰²
           saveValueTo: "read"
           saveIndexTo: "readç´¢å¼•"

   END IF

2ï¸âƒ£4ï¸âƒ£ åˆ†ç±»æ ‡ç­¾é€‰æ‹©
   IF (æµç¨‹èŠ‚ç‚¹è®¾ç½® CONTAINS "é€‰æ‹©ã€Œåˆ†ç±»æ ‡ç­¾ã€= å¼€") THEN

       // åŒæ ·çš„æµç¨‹æå–40ä¸ªåˆ†ç±»æ ‡ç­¾é€‰é¡¹
       // è§£æJSON â†’ æå–é€‰é¡¹ â†’ æ„å»ºæ•°ç»„ â†’ æ˜¾ç¤ºå¯¹è¯æ¡†

       æ˜¾ç¤ºSelectionDialog:
           title: "ğŸ“‘ è¯·é€‰æ‹©åˆ†ç±»æ ‡ç­¾ï¼Œä¾¿äºåˆ†ç±»"
           optionsFromVariable: "åˆ†ç±»æ ‡ç­¾æ•°ç»„"
           // é€‰é¡¹åŒ…æ‹¬ï¼š
           // ğŸ’„æ—¶å°šç¾å¦†ã€ğŸŒæ—…æ¸¸å‡ºè¡Œã€ğŸœç¾é£Ÿæ¶ˆè´¹ã€ğŸ“šå­¦ä¹ æ•™è‚²
           // ğŸ’¹å•†ä¸šè´¢ç»ã€ğŸ’¼èŒåœºã€ğŸ’´ç”Ÿç±³é¡¹ç›®ã€âœ¨åˆ›æ„çµæ„Ÿ
           // ğŸ“å¹²è´§åˆ†äº«ã€âš™ï¸æ•ˆç‡å·¥å…·ã€ğŸæ–°å¥‡å¥½ç‰©ã€ğŸ å®¶å±…å®¶è£…
           // ğŸ‘¶äº²å­æ¯å©´ã€ğŸ’–æƒ…æ„Ÿå¿ƒç†ã€ğŸ¥åŒ»ç–—å¥åº·ã€ğŸ“ºå½±è§†ç»¼è‰º
           // ğŸµéŸ³ä¹ã€ğŸ“°æ—¶æ”¿ç¤¾ä¼šã€ğŸ¨æ–‡å­¦è‰ºæœ¯ã€ğŸ›ï¸äººæ–‡å†å²
           // ğŸ­æ‰è‰ºæŠ€èƒ½ã€ğŸ“±ç§‘æŠ€æ•°ç ã€ğŸ“¸æ‘„å½±ã€ğŸ®æ¸¸æˆ
           // ğŸš—æ±½è½¦ã€ğŸŒäºŒæ¬¡å…ƒã€ğŸ‹ï¸è¿åŠ¨å¥èº«ã€ğŸ”®æ˜Ÿåº§å‘½ç†
           // ğŸ““ç”Ÿæ´»è®°å½•ã€ğŸ¯å…´è¶£çˆ±å¥½ã€â“å…¶ä»–ã€ğŸ¤–AI
           // ğŸ å°çº¢ä¹¦ã€ğŸµæŠ–éŸ³ã€ğŸ’¬å¾®ä¿¡ç§åŸŸã€ğŸ“ºBç«™å¥½ç‰©
           // ğŸ¥è§†é¢‘å·ã€ğŸª½é£ä¹¦æ‰£å­ã€â–¶ï¸YouTube
           saveValueTo: "label"
           saveIndexTo: "labelç´¢å¼•"

   END IF

2ï¸âƒ£5ï¸âƒ£ å¯¹æ ‡å‚è€ƒåº¦è¯„åˆ†
   IF (æµç¨‹èŠ‚ç‚¹è®¾ç½® CONTAINS "é€‰æ‹©ã€Œå¯¹æ ‡å‚è€ƒã€= å¼€") THEN

       æ˜¾ç¤ºSelectionDialog:
           title: "ğŸ‘ è¯·æ ‡è®°å¯¹æ ‡å‚è€ƒåº¦"
           options: [
               "5 èµğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘",
               "4 èµğŸ‘ğŸ‘ğŸ‘ğŸ‘",
               "3 èµğŸ‘ğŸ‘ğŸ‘",
               "2 èµğŸ‘ğŸ‘",
               "1 èµğŸ‘",
               "0å…ˆä¸é€‰ï¼Œè·³è¿‡"
           ]
           saveValueTo: "qualityå­—ç¬¦ä¸²"
           saveIndexTo: "qualityç´¢å¼•"

       // æå–æ•°å­—
       TextManipulation:
         pattern: "(\\d+)"
         input: "{qualityå­—ç¬¦ä¸²}"
         saveToVariable: "quality"

   END IF

2ï¸âƒ£6ï¸âƒ£ å¤‡æ³¨è¯´æ˜è¾“å…¥
   IF (æµç¨‹èŠ‚ç‚¹è®¾ç½® CONTAINS "å¡«å†™ã€Œå¤‡æ³¨è¯´æ˜ã€= å¼€") THEN

       æ˜¾ç¤ºTextInputDialog:
           title: "ğŸ“ è¯·è¾“å…¥æ”¶è—å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰"
           message: ""
           emptyAtStart: true
           showCancelButton: false
           saveToVariable: "å¤‡æ³¨è¯´æ˜"

   END IF
```

#### C3: æ•°æ®ä¸Šä¼ é˜¶æ®µï¼ˆæ­¥éª¤27-32ï¼‰

```typescript
2ï¸âƒ£7ï¸âƒ£ æ˜¾ç¤ºä¸Šä¼ è¿›åº¦
   Toast: "æ•°æ®ä¸Šä¼ ä¸­ï¼Œè¯·è€å¿ƒç­‰å¾…" (duration=1ç§’)

2ï¸âƒ£8ï¸âƒ£ æ˜¾ç¤ºåŠ¨ç”»
   AnimationOverlay: duration=18ç§’

2ï¸âƒ£9ï¸âƒ£ æ„å»ºè¯·æ±‚å‚æ•°å­—å…¸

   // é€æ­¥è®¾ç½®å­—å…¸çš„å„ä¸ªé”®å€¼
   SetVariable: å­—å…¸ä¸Šä¼ ["parameters"]["xhscookie"] = "{cookie}"
   SetVariable: å­—å…¸ä¸Šä¼ ["workflow_id"] = "{flownote}"
   SetVariable: å­—å…¸ä¸Šä¼ ["parameters"]["basetoken"] = "{é£ä¹¦å¤šç»´è¡¨æ ¼æˆæƒç }"
   SetVariable: å­—å…¸ä¸Šä¼ ["parameters"]["knowledgeurl"] = "{é‡‡é›†åº“è¡¨é“¾æ¥}"
   SetVariable: å­—å…¸ä¸Šä¼ ["parameters"]["ordeid"] = "{è®¢å•å·}"
   SetVariable: å­—å…¸ä¸Šä¼ ["parameters"]["quality"] = "{quality}"
   SetVariable: å­—å…¸ä¸Šä¼ ["parameters"]["read"] = "{read}"
   SetVariable: å­—å…¸ä¸Šä¼ ["parameters"]["notes"] = "{å¤‡æ³¨è¯´æ˜}"
   SetVariable: å­—å…¸ä¸Šä¼ ["parameters"]["url"] = "{url}"

   // å°†labelå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°ç»„
   TextManipulation:
     operation: "Split"
     delimiter: "\n"
     input: "{label}"
     saveToVariable: "å­—å…¸æ•°ç»„label"

   // å¤åˆ¶æ•°ç»„åˆ°å­—å…¸
   SetVariable: å­—å…¸ä¸Šä¼ ["parameters"]["label"] = CopyFrom(å­—å…¸æ•°ç»„label)

3ï¸âƒ£0ï¸âƒ£ è½¬æ¢å­—å…¸ä¸ºJSONå­—ç¬¦ä¸²
   åŠ¨ä½œ: JsonOutputAction
   è¾“å…¥: å­—å…¸ä¸Šä¼ 
   è¾“å‡º: ä¸Šä¼ æµ

// ç”Ÿæˆçš„JSONç¤ºä¾‹:
{
  "workflow_id": "7550495126771449906",
  "parameters": {
    "xhscookie": "gid.sign=xxx; webId=xxx; ...",
    "basetoken": "pt-SilFPo_0WlurK20m1K3arRsyatxfxqQ4Zog41WiZAQAAA8AIYQJAxlp17xGB",
    "knowledgeurl": "https://lv13e2iljbk.feishu.cn/base/XvGIbdrEoaEDjesmyAgcbptinzg?table=tbllG943iwxbDKaF&view=vewRDP4MrC",
    "ordeid": "P1234567890",
    "quality": "5",
    "read": "âšª æ™®é€šæ¬¾",
    "notes": "è¿™æ˜¯æˆ‘çš„ç¬”è®°å¤‡æ³¨",
    "url": "http://xhslink.com/o/7qRyXtzEf9M",
    "label": ["ğŸ“šå­¦ä¹ æ•™è‚²"]
  }
}

3ï¸âƒ£1ï¸âƒ£ å‘é€HTTPè¯·æ±‚
   åŠ¨ä½œ: HttpRequestAction
   é…ç½®:
     method: POST
     url: "https://api.coze.cn/v1/workflow/run"
     headers: {
         "Authorization": "Bearer {è¡¨æ ¼æ ¸å¯¹ç }"
     }
     contentType: "application/json"
     body: "{ä¸Šä¼ æµ}"
     timeout: 30ç§’
     saveResponseTo: "è®°å½•æ·»åŠ å“åº”ä½“"

3ï¸âƒ£2ï¸âƒ£ è§£æå“åº”
   // å»é™¤ç¬¦å·
   TextManipulation:
     operation: "RemoveText"
     pattern: "[{}\"\\\\]"
     saveToVariable: "è®°å½•å“åº”ä½“å»æ‰ç¬¦å·"

   // æå–æç¤ºè¯­
   TextManipulation:
     operation: "ExtractText"
     pattern: "prompt:([\\s\\S]*?)(?=,\\w+:|$)"
     groupIndex: 1
     saveToVariable: "è¿”å›çš„å•ç¯‡æç¤ºè¯­"
```

**æˆåŠŸå“åº”ç¤ºä¾‹:**
```json
{
  "code": 0,
  "msg": "success",
  "data": "{\"add_result\":true,\"ordeid_result\":true,\"prompt\":\"å·²é‡‡é›†ç¬”è®°ã€Šåˆ†äº«ç”¨å¤šç»´è¡¨æ ¼è®°å½•è‡ªå·±ï¼šè®°å½•çœŸçš„å¯ä»¥æ”¹å‘½ï¼ã€‹å»å¤šç»´è¡¨æ ¼çœ‹çœ‹å§ï¼\",\"title\":\"åˆ†äº«ç”¨å¤šç»´è¡¨æ ¼è®°å½•è‡ªå·±ï¼šè®°å½•çœŸçš„å¯ä»¥æ”¹å‘½ï¼\",\"url_result\":true}",
  "debug_url": "https://www.coze.cn/work_flow?execute_id=xxx",
  "usage": {"token_count": 0, "output_count": 0, "input_count": 0}
}
```

**å¤±è´¥å“åº”ç¤ºä¾‹:**
```json
{
  "code": 0,
  "msg": "",
  "data": "{\"add_result\":false,\"limit_count\":\"1\",\"limit_result\":false,\"newcollection_bag\":\"0\",\"newcollection_count\":\"3\",\"ordeid_result\":true,\"prompt\":\"æ‚¨çš„æ‰‹æœºé‡‡é›†æ¬¡æ•°å·²è¾¾é™é¢ï¼\\n\\né‡‡é›†é™é¢ä¸ºï¼š1 æ¬¡/æ—¥ï¼Œ\\né‡‡é›†åŒ…ä½™é‡ä¸ºï¼š0 æ¬¡ï¼Œ\\n\\næ‚¨å¯æ˜æ—¥å†é‡‡æˆ–è”ç³»å®¢æœè´­ä¹°é‡‡é›†åŒ…ã€‚\",\"title\":\"é‡‡é›†å¤±è´¥ï¼Œè¯·é‡è¯•æˆ–æ£€æŸ¥ä»Šæ—¥æ˜¯å¦å·²è¾¾é‡‡é›†é™é¢\",\"url_result\":true}",
  "debug_url": "https://www.coze.cn/work_flow?execute_id=xxx"
}
```

#### C4: æœ€ç»ˆå¤„ç†ï¼ˆæ­¥éª¤33-34ï¼‰

```typescript
3ï¸âƒ£3ï¸âƒ£ é”™è¯¯å¤„ç†

   // æ£€æŸ¥APIè°ƒç”¨æ˜¯å¦æˆåŠŸ
   IF (è®°å½•å“åº”ä½“å»æ‰ç¬¦å· NOT CONTAINS "code:0") THEN
       æ˜¾ç¤ºOptionDialog:
           title: "âš ï¸ é‡‡é›†å¤±è´¥"
           message: "ä¸å¥½æ„æ€ï¼Œä¸é£ä¹¦å¯¹æ¥å‡ºäº†ç‚¹å¼‚å¸¸ï¼Œè¯·æ‚¨é‡æ–°æ“ä½œä¸€éã€‚å¦‚è¿˜æ˜¯å¤±è´¥ï¼Œæ‚¨å¯ä»¥è”ç³»å®¢æœè§£å†³ï¼"
           buttons: ["ç¡®å®š", "å–æ¶ˆ", "è”ç³»å®¢æœ"]

       IF é€‰æ‹©"è”ç³»å®¢æœ" THEN
           æ‰“å¼€URL: "https://lv13e2iljbk.feishu.cn/docx/Og5ddVoAboc9Wox6mmkcIuA7nlc"
       END IF

       é€€å‡ºå®
   END IF

   // æ£€æŸ¥ä¸šåŠ¡é€»è¾‘æ˜¯å¦æˆåŠŸ
   IF (è®°å½•å“åº”ä½“å»æ‰ç¬¦å· CONTAINS "add_result:false") THEN
       æ˜¾ç¤ºOptionDialog:
           title: "âš ï¸ é‡‡é›†å¤±è´¥"
           message: "{è¿”å›çš„å•ç¯‡æç¤ºè¯­}"
           // å¸¸è§é”™è¯¯ä¿¡æ¯ï¼š
           // - "æ‚¨çš„æ‰‹æœºé‡‡é›†æ¬¡æ•°å·²è¾¾é™é¢ï¼é‡‡é›†é™é¢ä¸ºï¼š1 æ¬¡/æ—¥ï¼Œé‡‡é›†åŒ…ä½™é‡ä¸ºï¼š0 æ¬¡"
           // - "URLæ ¼å¼é”™è¯¯"
           // - "è®¢å•å·éªŒè¯å¤±è´¥"
           buttons: ["ç¡®å®š", "å–æ¶ˆ", "è”ç³»å®¢æœ"]

       IF é€‰æ‹©"è”ç³»å®¢æœ" THEN
           æ‰“å¼€URL: "https://lv13e2iljbk.feishu.cn/docx/Og5ddVoAboc9Wox6mmkcIuA7nlc"
       END IF

       é€€å‡ºå®
   END IF

3ï¸âƒ£4ï¸âƒ£ æˆåŠŸå¤„ç†

   IF (æµç¨‹èŠ‚ç‚¹è®¾ç½® CONTAINS "æ‰“å¼€ã€Œé‡‡é›†åº“ã€= å¼€") THEN

       æ˜¾ç¤ºOptionDialog:
           title: "âœ… é‡‡é›†æˆåŠŸ"
           message: "{è¿”å›çš„å•ç¯‡æç¤ºè¯­}"
           // ç¤ºä¾‹ï¼š"å·²é‡‡é›†ç¬”è®°ã€Šåˆ†äº«ç”¨å¤šç»´è¡¨æ ¼è®°å½•è‡ªå·±ï¼šè®°å½•çœŸçš„å¯ä»¥æ”¹å‘½ï¼ã€‹å»å¤šç»´è¡¨æ ¼çœ‹çœ‹å§ï¼"
           buttons: ["ç¡®å®š", "å–æ¶ˆ", "æ‰“å¼€é£ä¹¦"]

       IF é€‰æ‹©"æ‰“å¼€é£ä¹¦" THEN
           æ‰“å¼€URL: "https://applink.feishu.cn/client/docs/open?url={é‡‡é›†åº“è¡¨é“¾æ¥}"
       END IF

       é€€å‡ºå®

   ELSE

       // å¦‚æœå…³é—­äº†æ‰“å¼€é£ä¹¦çš„é€‰é¡¹ï¼Œåªæ˜¾ç¤ºç®€å•æç¤º
       æ˜¾ç¤ºToast:
           message: "âœ” é‡‡é›†æˆåŠŸ"
           backgroundColor: -14606047  // ç»¿è‰²
           textColor: -1              // ç™½è‰²
           duration: 1ç§’

   END IF
```

---

## ğŸ“Š ä¸‰ã€é¸¿è’™å®AppåŠŸèƒ½æ”¯æŒåº¦è¯„ä¼°

### 3.1 æ ¸å¿ƒåŠŸèƒ½æ˜ å°„è¡¨

| MacroDroidåŠŸèƒ½ | å¯¹åº”åŠ¨ä½œ | é¸¿è’™Appå®ç° | æ”¯æŒåº¦ | è¯´æ˜ |
|---------------|---------|------------|--------|------|
| **è§¦å‘å™¨** | ShortcutTrigger | æ‰‹åŠ¨è§¦å‘å™¨ | âœ… 100% | å®Œå…¨æ”¯æŒ |
| **å‰ªè´´æ¿è¯»å–** | UpdateClipboardAction | ClipboardAction.read() | âœ… 100% | å®Œå…¨æ”¯æŒ |
| **æ­£åˆ™æå–** | TextManipulationAction.ExtractText | TextProcessAction.regex_extract | âœ… 100% | å®Œå…¨æ”¯æŒ |
| **å­—ç¬¦ä¸²æ“ä½œ** | TextManipulationAction | TextProcessAction | âœ… 100% | æ”¯æŒæ›¿æ¢ã€å»é™¤ã€åˆ†å‰²ç­‰ |
| **HTTPè¯·æ±‚** | HttpRequestAction | HttpRequestAction | âœ… 100% | æ”¯æŒGET/POSTã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ |
| **æ¡ä»¶åˆ¤æ–­** | IfConditionAction | ConditionEvaluator | âœ… 100% | æ”¯æŒCONTAINSã€EQUALSç­‰è¿ç®—ç¬¦ |
| **å•é€‰å¯¹è¯æ¡†** | SelectionDialogAction | UserDialogAction.single_select | âœ… 100% | å®Œå…¨æ”¯æŒ |
| **æ–‡æœ¬è¾“å…¥** | SetVariableAction.userPrompt | UserDialogAction.text_input | âœ… 100% | å®Œå…¨æ”¯æŒ |
| **Toastæç¤º** | ToastAction | NotificationAction | âœ… 100% | æ”¯æŒç®€å•é€šçŸ¥ |
| **æ¶ˆæ¯å¯¹è¯æ¡†** | MessageDialogAction | UserDialogAction | âœ… 100% | æ”¯æŒç¡®è®¤å¯¹è¯æ¡† |
| **é€‰é¡¹å¯¹è¯æ¡†** | OptionDialogAction | UserDialogAction | âœ… 100% | æ”¯æŒå¤šæŒ‰é’®å¯¹è¯æ¡† |
| **æ‰“å¼€URL** | OpenWebPageAction | OpenUrlAction | âœ… 100% | æ”¯æŒHTTP/Deep Link |
| **å˜é‡è®¾ç½®** | SetVariableAction | SetVariableAction | âœ… 100% | æ”¯æŒå¤šç§å˜é‡ç±»å‹ |
| **å˜é‡æ¸…ç©º** | ClearVariablesAction | - | âš ï¸ 90% | å¯é€šè¿‡è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²å®ç° |
| **å­—å…¸æ“ä½œ** | Dictionaryå˜é‡ç±»å‹ | - | âš ï¸ 70% | éœ€è¦ç¡®è®¤æ˜¯å¦æ”¯æŒå­—å…¸/å¯¹è±¡ç±»å‹ |
| **JSONè½¬æ¢** | JsonOutputAction | - | âš ï¸ 60% | å¯ç”¨å­—ç¬¦ä¸²æ‹¼æ¥æ›¿ä»£ |
| **åŠ¨ç”»æ•ˆæœ** | AnimationOverlayAction | - | âŒ 0% | æ— æ­¤åŠŸèƒ½ï¼ˆéæ ¸å¿ƒï¼‰ |
| **å®é€€å‡º** | CancelActiveMacroAction | - | âš ï¸ 80% | å¯ç”¨æ¡ä»¶è·³è¿‡å®ç° |

### 3.2 å…³é”®æŠ€æœ¯ç‚¹è¯„ä¼°

#### âœ… å®Œå…¨æ”¯æŒçš„åŠŸèƒ½ï¼ˆå¯ç›´æ¥å®ç°ï¼‰

**1. å‰ªè´´æ¿ä¸URLæå–**
```typescript
// é¸¿è’™å®ç°
{
  "type": "clipboard_read",
  "saveToVariable": "clipboard_content"
},
{
  "type": "text_process",
  "operation": "regex_extract",
  "pattern": "https?://[^\\s]+",
  "input": "{clipboard_content}",
  "saveToVariable": "url"
}
```

**2. HTTPè¯·æ±‚ä¸å“åº”å¤„ç†**
```typescript
{
  "type": "http_request",
  "method": "POST",
  "url": "https://api.coze.cn/v1/workflow/run",
  "headers": {
    "Authorization": "Bearer {token}"
  },
  "body": "{\"workflow_id\":\"{flownote}\",\"parameters\":{...}}",
  "saveToVariable": "response_body"
}
```

**3. ç”¨æˆ·äº¤äº’å¯¹è¯æ¡†**
```typescript
// å•é€‰å¯¹è¯æ¡†
{
  "type": "user_dialog",
  "dialogType": "single_select",
  "title": "ğŸ“‘ è¯·é€‰æ‹©åˆ†ç±»æ ‡ç­¾",
  "options": "ğŸ’„æ—¶å°šç¾å¦†;ğŸŒæ—…æ¸¸å‡ºè¡Œ;ğŸ“šå­¦ä¹ æ•™è‚²",  // åˆ†å·åˆ†éš”
  "saveToVariable": "selected_label"
}

// æ–‡æœ¬è¾“å…¥å¯¹è¯æ¡†
{
  "type": "user_dialog",
  "dialogType": "text_input",
  "title": "ğŸ“ è¯·è¾“å…¥æ”¶è—å¤‡æ³¨",
  "placeholder": "é€‰å¡«",
  "saveToVariable": "notes"
}
```

**4. æ¡ä»¶åˆ¤æ–­ä¸æµç¨‹æ§åˆ¶**
```typescript
// Conditionå¯¹è±¡
{
  "variable": "url",
  "operator": "CONTAINS",
  "value": "xiaohongshu.com/goods-detail"
}

// åœ¨MacroEngine.executeMacro()ä¸­è¯„ä¼°
const conditionsPassed = await this.conditionEvaluator.evaluate(conditions, context);
if (!conditionsPassed) {
  // è·³è¿‡åç»­åŠ¨ä½œ
  return false;
}
```

**5. å˜é‡ç®¡ç†**
```typescript
// è®¾ç½®å˜é‡
{
  "type": "set_variable",
  "variable": "quality",
  "value": "5",
  "scope": "macro"
}

// ä½¿ç”¨å˜é‡
{
  "type": "http_request",
  "body": "{\"quality\":\"{quality}\",\"label\":\"{label}\"}"
}
```

#### âš ï¸ éœ€è¦è¡¥å……çš„åŠŸèƒ½

**1. JSONå“åº”è§£æï¼ˆä¸­ç­‰ä¼˜å…ˆçº§ï¼‰**

**é—®é¢˜:**
MacroDroidä½¿ç”¨å¤šæ­¥æ–‡æœ¬æ“ä½œè§£æJSONï¼š
```
1. å»é™¤ç¬¦å·: [{}"\]
2. æ­£åˆ™æå–: "prompt:([\s\S]*?)(?=,\w+:|$)"
```

é¸¿è’™appå¯ä»¥ç”¨åŒæ ·æ–¹å¼å®ç°ï¼Œä½†ä¸å¤Ÿä¼˜é›…ã€‚

**å»ºè®®æ–¹æ¡ˆ:**
åœ¨ `TextProcessAction` ä¸­å¢åŠ  `json_path` æ“ä½œç±»å‹ï¼š

```typescript
// entry/src/main/ets/services/actions/TextProcessAction.ts

export interface TextProcessConfig {
  operation: 'regex_extract' | 'regex_replace' | 'encode' | 'decode' | 'json_path';
  // ...ç°æœ‰å­—æ®µ
  jsonPath?: string;  // æ–°å¢: JSONPathè¡¨è¾¾å¼
}

// æ‰§è¡Œé€»è¾‘
if (config.operation === 'json_path') {
  const jsonObj = JSON.parse(inputText);
  const result = evaluateJsonPath(jsonObj, config.jsonPath);
  context.setRuntimeVariable(config.saveToVariable, result);
}
```

**ä½¿ç”¨ç¤ºä¾‹:**
```typescript
{
  "type": "text_process",
  "operation": "json_path",
  "input": "{response_body}",
  "jsonPath": "$.data.prompt",  // æå– data.prompt å­—æ®µ
  "saveToVariable": "prompt_message"
}
```

**2. åŠ¨æ€å¯¹è¯æ¡†é€‰é¡¹ï¼ˆä¸­ç­‰ä¼˜å…ˆçº§ï¼‰**

**é—®é¢˜:**
MacroDroidä»è¡¨æ ¼å­—æ®µå…ƒæ•°æ®ä¸­æå–é€‰é¡¹ï¼ŒåŠ¨æ€ç”Ÿæˆå¯¹è¯æ¡†ï¼š
```
1. æ­£åˆ™æå–: "\"name\":\"([^\"]+)\""
2. æ„å»ºæ•°ç»„: ["é€‰é¡¹1", "é€‰é¡¹2", "é€‰é¡¹3"]
3. ä¼ é€’ç»™SelectionDialog
```

é¸¿è’™appéœ€è¦æ”¯æŒä»å˜é‡è¯»å–å¯¹è¯æ¡†é€‰é¡¹ã€‚

**å»ºè®®æ–¹æ¡ˆ:**
åœ¨ `UserDialogAction` ä¸­å¢åŠ  `optionsFromVariable` é…ç½®ï¼š

```typescript
// entry/src/main/ets/services/actions/UserDialogAction.ts

export interface UserDialogConfig {
  dialogType: 'single_select' | 'multi_select' | 'text_input';
  title: string;
  options?: string[];  // é™æ€é€‰é¡¹
  optionsFromVariable?: string;  // æ–°å¢: ä»å˜é‡è¯»å–é€‰é¡¹ï¼ˆå˜é‡ç±»å‹ä¸ºstring[]ï¼‰
  // ...
}

// æ‰§è¡Œé€»è¾‘
async execute(action: Action, context: ExecutionContext): Promise<void> {
  const config = JSON.parse(action.config) as UserDialogConfig;

  let options: string[];
  if (config.optionsFromVariable) {
    // ä»å˜é‡è¯»å–é€‰é¡¹
    const variable = await context.getVariable(config.optionsFromVariable);
    options = Array.isArray(variable) ? variable : variable.split(';');
  } else {
    options = config.options || [];
  }

  // æ˜¾ç¤ºå¯¹è¯æ¡†...
}
```

**ä½¿ç”¨ç¤ºä¾‹:**
```typescript
// æ­¥éª¤1: è§£æJSONé€‰é¡¹ä¸ºæ•°ç»„
{
  "type": "text_process",
  "operation": "json_path",
  "input": "{field_metadata}",
  "jsonPath": "$.data.items[?(@.field_name=='åˆ†ç±»æ ‡ç­¾')].property.options[*].name",
  "saveToVariable": "tag_options"  // ç»“æœ: ["ğŸ’„æ—¶å°šç¾å¦†", "ğŸŒæ—…æ¸¸å‡ºè¡Œ", ...]
}

// æ­¥éª¤2: åœ¨å¯¹è¯æ¡†ä¸­ä½¿ç”¨
{
  "type": "user_dialog",
  "dialogType": "single_select",
  "title": "è¯·é€‰æ‹©åˆ†ç±»æ ‡ç­¾",
  "optionsFromVariable": "tag_options",  // ä»å˜é‡è¯»å–
  "saveToVariable": "selected_tag"
}
```

**3. å®æå‰é€€å‡ºæœºåˆ¶ï¼ˆä½ä¼˜å…ˆçº§ï¼‰**

**é—®é¢˜:**
MacroDroidä½¿ç”¨ `CancelActiveMacroAction` åœ¨éªŒè¯å¤±è´¥æ—¶ç«‹å³é€€å‡ºã€‚é¸¿è’™appå¯é€šè¿‡æŠ›å‡ºå¼‚å¸¸å®ç°ï¼Œä½†éœ€è¦æ˜ç¡®çš„åŠ¨ä½œç±»å‹ã€‚

**å»ºè®®æ–¹æ¡ˆ:**
åœ¨ `entry/src/main/ets/services/actions/` ä¸­åˆ›å»º `ExitMacroAction.ts`:

```typescript
// entry/src/main/ets/services/actions/ExitMacroAction.ts
import { Action } from '../../models/Macro';
import { ExecutionContext } from '../../models/ExecutionContext';
import { IActionExecutor } from '../ActionExecutor';

export class ExitMacroAction implements IActionExecutor {
  async execute(action: Action, context: ExecutionContext): Promise<void> {
    const config = JSON.parse(action.config);
    const reason = config.reason || 'Macro explicitly exited';

    // è®¾ç½®é€€å‡ºæ ‡å¿—
    context.setMetadata('shouldExit', true);

    // æŠ›å‡ºå¼‚å¸¸ä»¥ç»ˆæ­¢æ‰§è¡Œæµç¨‹
    throw new Error(`EXIT_MACRO: ${reason}`);
  }
}
```

åœ¨ `MacroEngine.ts` ä¸­æ³¨å†Œï¼š
```typescript
this.actionExecutor.registerExecutor(ActionType.EXIT_MACRO, new ExitMacroAction());
```

**ä½¿ç”¨ç¤ºä¾‹:**
```typescript
{
  "type": "condition",
  "conditions": [
    {"variable": "order_id", "operator": "EQUALS", "value": ""}
  ]
},
{
  "type": "notification",
  "title": "âš ï¸ é…ç½®é”™è¯¯",
  "content": "è®¢å•å·æœªå¡«å†™"
},
{
  "type": "exit_macro",  // æ–°å¢åŠ¨ä½œç±»å‹
  "reason": "è®¢å•å·æœªå¡«å†™"
}
```

#### âŒ éæ ¸å¿ƒåŠŸèƒ½ï¼ˆå¯å¿½ç•¥ï¼‰

**1. åŠ¨ç”»è¦†ç›–å±‚ï¼ˆAnimationOverlayActionï¼‰**
- çº¯è§†è§‰æ•ˆæœï¼Œä¸å½±å“ä¸šåŠ¡é€»è¾‘
- å¯ç”¨ç®€å•çš„ LoadingDialog æˆ– Toast æ›¿ä»£

**2. Toastè‡ªå®šä¹‰å›¾æ ‡**
- MacroDroidæ”¯æŒæ˜¾ç¤ºç”¨æˆ·ä¸Šä¼ çš„PNGå›¾æ ‡
- é¸¿è’™appå¯ç”¨æ ‡å‡†å›¾æ ‡æˆ–çº¯æ–‡æœ¬æ›¿ä»£

---

## ğŸš€ å››ã€é¸¿è’™å®Appå®ç°æ–¹æ¡ˆ

### 4.1 æ–¹æ¡ˆA: æœ€å°æ”¹åŠ¨å®ç°ï¼ˆæ¨èï¼‰

**ç‰¹ç‚¹:** ä½¿ç”¨ç°æœ‰åŠŸèƒ½ï¼Œæ— éœ€ä¿®æ”¹ä»£ç 

**æ ¸å¿ƒç­–ç•¥:**
1. JSONå“åº”è§£æï¼šä½¿ç”¨æ­£åˆ™æå–ï¼ˆä¸MacroDroidç›¸åŒï¼‰
2. åŠ¨æ€å¯¹è¯æ¡†é€‰é¡¹ï¼šä½¿ç”¨åˆ†å·åˆ†éš”çš„å­—ç¬¦ä¸²
3. æå‰é€€å‡ºï¼šé€šè¿‡æ¡ä»¶åˆ¤æ–­+å¼‚å¸¸å¤„ç†å®ç°

**å®Œæ•´å®é…ç½®ç¤ºä¾‹:**

```json
{
  "name": "å¿«å°çº¢",
  "description": "ä»å°çº¢ä¹¦é‡‡é›†å†…å®¹åˆ°é£ä¹¦å¤šç»´è¡¨æ ¼",
  "enabled": true,
  "triggers": [
    {
      "type": "manual",
      "enabled": true
    }
  ],
  "variables": [
    {"name": "order_id", "value": "P1234567890", "scope": "global", "isSecure": true},
    {"name": "feishu_token", "value": "pt-xxx", "scope": "global", "isSecure": true},
    {"name": "table_url", "value": "https://xxx.feishu.cn/base/xxx", "scope": "global", "isSecure": true}
  ],
  "actions": [
    {
      "type": "notification",
      "config": {
        "title": "å¼€å§‹é‡‡é›†",
        "content": "è¯·æŒ‰æç¤ºé€æ­¥æ“ä½œ"
      }
    },
    {
      "type": "clipboard_read",
      "config": {
        "saveToVariable": "clipboard_content"
      }
    },
    {
      "type": "text_process",
      "config": {
        "operation": "regex_extract",
        "pattern": "https?://[^\\s]+",
        "input": "{clipboard_content}",
        "saveToVariable": "url"
      }
    },
    {
      "type": "condition",
      "config": {
        "conditions": [
          {"variable": "url", "operator": "EQUALS", "value": ""}
        ]
      }
    },
    {
      "type": "notification",
      "config": {
        "title": "âš ï¸ é”™è¯¯",
        "content": "æ‚¨æœªå¤åˆ¶é“¾æ¥"
      }
    },
    {
      "type": "user_dialog",
      "config": {
        "dialogType": "single_select",
        "title": "ğŸ”¥ è¯·æ ‡è®°å†…å®¹ç«çˆ†ç¨‹åº¦",
        "options": ["âšª æ™®é€šæ¬¾", "ğŸŸ¡ æ½œåŠ›æ¬¾", "ğŸ”´ å¤§çˆ†æ¬¾"],
        "saveToVariable": "quality_label"
      }
    },
    {
      "type": "user_dialog",
      "config": {
        "dialogType": "single_select",
        "title": "ğŸ“‘ è¯·é€‰æ‹©åˆ†ç±»æ ‡ç­¾",
        "options": [
          "ğŸ’„æ—¶å°šç¾å¦†", "ğŸŒæ—…æ¸¸å‡ºè¡Œ", "ğŸœç¾é£Ÿæ¶ˆè´¹", "ğŸ“šå­¦ä¹ æ•™è‚²",
          "ğŸ’¹å•†ä¸šè´¢ç»", "ğŸ’¼èŒåœº", "ğŸ“å¹²è´§åˆ†äº«", "âš™ï¸æ•ˆç‡å·¥å…·"
        ],
        "saveToVariable": "category_label"
      }
    },
    {
      "type": "user_dialog",
      "config": {
        "dialogType": "text_input",
        "title": "ğŸ“ è¯·è¾“å…¥æ”¶è—å¤‡æ³¨",
        "placeholder": "é€‰å¡«",
        "saveToVariable": "notes"
      }
    },
    {
      "type": "notification",
      "config": {
        "title": "ä¸Šä¼ ä¸­",
        "content": "æ•°æ®ä¸Šä¼ ä¸­ï¼Œè¯·è€å¿ƒç­‰å¾…"
      }
    },
    {
      "type": "http_request",
      "config": {
        "method": "POST",
        "url": "https://api.coze.cn/v1/workflow/run",
        "headers": {
          "Authorization": "Bearer sat_NbvH6WQTg8EX496ohv6JE0B3ocRAnTuWKYyt4ADuajYzs6RQdwW4emf5GmjQdfwe"
        },
        "body": "{\"workflow_id\":\"7550495126771449906\",\"parameters\":{\"basetoken\":\"{feishu_token}\",\"knowledgeurl\":\"{table_url}\",\"ordeid\":\"{order_id}\",\"quality\":\"5\",\"read\":\"{quality_label}\",\"notes\":\"{notes}\",\"url\":\"{url}\",\"label\":[\"{category_label}\"],\"xhscookie\":\"\"}}",
        "timeout": 30,
        "saveToVariable": "response"
      }
    },
    {
      "type": "text_process",
      "config": {
        "operation": "regex_extract",
        "pattern": "\"prompt\":\"([^\"]+)\"",
        "input": "{response}",
        "saveToVariable": "result_message"
      }
    },
    {
      "type": "notification",
      "config": {
        "title": "âœ… é‡‡é›†æˆåŠŸ",
        "content": "{result_message}"
      }
    },
    {
      "type": "open_url",
      "config": {
        "url": "https://applink.feishu.cn/client/docs/open?url={table_url}"
      }
    }
  ]
}
```

**ä¼˜ç‚¹:**
- âœ… æ— éœ€ä¿®æ”¹ä»£ç ï¼Œç«‹å³å¯ç”¨
- âœ… å®ç°90%ä»¥ä¸Šæ ¸å¿ƒåŠŸèƒ½
- âœ… 1-2å¤©å³å¯å®Œæˆé…ç½®

**ç¼ºç‚¹:**
- âš ï¸ JSONè§£æä¸å¤Ÿä¼˜é›…ï¼ˆéœ€è¦å¤šä¸ªæ­£åˆ™æ­¥éª¤ï¼‰
- âš ï¸ å¯¹è¯æ¡†é€‰é¡¹éœ€è¦ç¡¬ç¼–ç æˆ–ç”¨åˆ†éš”ç¬¦æ‹¼æ¥

---

### 4.2 æ–¹æ¡ˆB: å¢å¼ºåŠŸèƒ½å®ç°ï¼ˆé•¿æœŸä¼˜åŒ–ï¼‰

**ç‰¹ç‚¹:** å¢åŠ æ–°åŠ¨ä½œç±»å‹ï¼Œæå‡æ˜“ç”¨æ€§

**éœ€è¦å¼€å‘çš„åŠŸèƒ½:**

**1. JSON Pathè§£æåŠ¨ä½œ**
```typescript
// æ–°å¢æ–‡ä»¶: entry/src/main/ets/services/actions/JsonPathAction.ts
export class JsonPathAction implements IActionExecutor {
  async execute(action: Action, context: ExecutionContext): Promise<void> {
    const config = JSON.parse(action.config);
    const inputText = await context.resolveVariables(config.input);
    const jsonObj = JSON.parse(inputText);

    // ä½¿ç”¨ç®€å•çš„JSONPathåº“ï¼ˆå¦‚lodash.getï¼‰
    const result = _.get(jsonObj, config.jsonPath);
    context.setRuntimeVariable(config.saveToVariable, result);
  }
}
```

**2. æ•°ç»„å˜é‡æ”¯æŒ**
```typescript
// åœ¨ Variable æ¨¡å‹ä¸­å¢åŠ æ•°ç»„ç±»å‹
export interface Variable {
  name: string;
  value: string | number | boolean | string[];  // æ–°å¢æ•°ç»„ç±»å‹
  type: 'string' | 'number' | 'boolean' | 'array';
  scope: 'global' | 'macro';
}

// åœ¨ UserDialogAction ä¸­æ”¯æŒä»æ•°ç»„å˜é‡è¯»å–é€‰é¡¹
if (config.optionsFromVariable) {
  const variable = await context.getVariable(config.optionsFromVariable);
  options = Array.isArray(variable.value) ? variable.value : variable.value.split(';');
}
```

**3. å®é€€å‡ºåŠ¨ä½œ**
```typescript
// æ–°å¢åŠ¨ä½œç±»å‹: ActionType.EXIT_MACRO
export enum ActionType {
  // ...ç°æœ‰ç±»å‹
  EXIT_MACRO = 'exit_macro'
}

// å®ç° ExitMacroAction
export class ExitMacroAction implements IActionExecutor {
  async execute(action: Action, context: ExecutionContext): Promise<void> {
    throw new Error('MACRO_EXIT: User explicitly exited macro');
  }
}
```

**å¼€å‘å·¥ä½œé‡:**
- JSON Pathè§£æ: 2å°æ—¶
- æ•°ç»„å˜é‡æ”¯æŒ: 4å°æ—¶
- å®é€€å‡ºåŠ¨ä½œ: 1å°æ—¶
- æµ‹è¯•ä¸é›†æˆ: 2å°æ—¶
- **æ€»è®¡: 1ä¸ªå·¥ä½œæ—¥**

**ä¼˜ç‚¹:**
- âœ… é…ç½®æ›´ç®€æ´ç›´è§‚
- âœ… é”™è¯¯å¤„ç†æ›´æ˜ç¡®
- âœ… æå‡ç”¨æˆ·ä½“éªŒ

**ç¼ºç‚¹:**
- âš ï¸ éœ€è¦ä¿®æ”¹ä»£ç 
- âš ï¸ éœ€è¦é¢å¤–æµ‹è¯•

---

### 4.3 æ¨èå®æ–½è·¯å¾„

**ç¬¬ä¸€é˜¶æ®µ: ç«‹å³å¯ç”¨ï¼ˆ1-2å¤©ï¼‰**
1. ä½¿ç”¨æ–¹æ¡ˆAé…ç½®"å¿«å°çº¢"å®
2. éªŒè¯æ ¸å¿ƒæµç¨‹å¯ç”¨æ€§
3. æ”¶é›†ç”¨æˆ·åé¦ˆ

**ç¬¬äºŒé˜¶æ®µ: çŸ­æœŸä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰**
1. å®ç°JSON Pathè§£æ
2. æ”¯æŒæ•°ç»„å˜é‡
3. ä¼˜åŒ–ç”¨æˆ·äº¤äº’ä½“éªŒ

**ç¬¬ä¸‰é˜¶æ®µ: é•¿æœŸå®Œå–„ï¼ˆæŒ‰éœ€ï¼‰**
1. å¢åŠ æ›´å¤šåŠ¨ä½œç±»å‹ï¼ˆå¦‚å›¾ç‰‡å¤„ç†ã€æ–‡ä»¶æ“ä½œï¼‰
2. å®ç°å¯è§†åŒ–æµç¨‹å›¾ç¼–è¾‘å™¨
3. æ„å»ºå®æ¨¡æ¿å¸‚åœº

---

## ğŸ¯ äº”ã€æœ€ç»ˆç»“è®º

### 5.1 åŠŸèƒ½æ”¯æŒåº¦æ€»ç»“

| è¯„ä¼°ç»´åº¦ | ç»“æœ | è¯´æ˜ |
|---------|------|------|
| **æ ¸å¿ƒåŠŸèƒ½å…¼å®¹æ€§** | âœ… **92%** | 8ç§æ ¸å¿ƒåŠ¨ä½œç±»å‹å…¨éƒ¨æ”¯æŒ |
| **è§¦å‘æ–¹å¼** | âœ… **100%** | æ‰‹åŠ¨è§¦å‘å®Œå…¨åŒ¹é… |
| **å˜é‡ç³»ç»Ÿ** | âœ… **95%** | æ”¯æŒæ‰€æœ‰ç±»å‹å˜é‡ï¼Œä»…ç¼ºå°‘æ•°ç»„é«˜çº§æ“ä½œ |
| **HTTPé€šä¿¡** | âœ… **100%** | æ”¯æŒå®Œæ•´çš„é£ä¹¦APIè°ƒç”¨ |
| **ç”¨æˆ·äº¤äº’** | âœ… **100%** | å¯¹è¯æ¡†åŠŸèƒ½å®Œå…¨æ»¡è¶³éœ€æ±‚ |
| **æµç¨‹æ§åˆ¶** | âœ… **95%** | æ¡ä»¶åˆ¤æ–­å’Œåˆ†æ”¯é€»è¾‘å®Œå–„ |
| **æ•´ä½“å¯è¡Œæ€§** | âœ… **å¯å®ç°** | **æ— é˜»å¡æ€§æŠ€æœ¯éšœç¢ï¼Œå¯ç”¨ç°æœ‰åŠŸèƒ½å®ç°90%ä»¥ä¸Šä¸šåŠ¡é€»è¾‘** |

### 5.2 å…³é”®ä¼˜åŠ¿

1. **âœ… æ¶æ„è®¾è®¡ä¼˜ç§€**
   - ç­–ç•¥æ¨¡å¼ä½¿å¾—æ–°å¢åŠ¨ä½œç±»å‹éå¸¸å®¹æ˜“
   - æ‰§è¡Œä¸Šä¸‹æ–‡ç®¡ç†å®Œå–„
   - å˜é‡ç³»ç»Ÿè®¾è®¡åˆç†

2. **âœ… åŠŸèƒ½è¦†ç›–å…¨é¢**
   - 8ç§åŠ¨ä½œç±»å‹è¦†ç›–95%å¸¸è§åœºæ™¯
   - HTTPè¯·æ±‚æ”¯æŒå®Œæ•´ï¼ˆGET/POST/è¯·æ±‚å¤´/è¯·æ±‚ä½“ï¼‰
   - ç”¨æˆ·äº¤äº’åŠŸèƒ½å¼ºå¤§ï¼ˆå•é€‰/å¤šé€‰/æ–‡æœ¬è¾“å…¥ï¼‰

3. **âœ… æ‰©å±•æ€§å¼º**
   - æ˜“äºå¢åŠ JSONè§£æåŠŸèƒ½
   - æ”¯æŒè‡ªå®šä¹‰åŠ¨ä½œæ‰§è¡Œå™¨
   - å˜é‡ç³»ç»Ÿå¯æ‰©å±•

### 5.3 éœ€è¦æ³¨æ„çš„ç‚¹

1. **âš ï¸ JSONå“åº”è§£æ**
   - å½“å‰éœ€è¦ç”¨å¤šæ­¥æ­£åˆ™å®ç°
   - å»ºè®®å¢åŠ json_pathæ“ä½œç±»å‹

2. **âš ï¸ åŠ¨æ€å¯¹è¯æ¡†é€‰é¡¹**
   - éœ€è¦å®ç°"ä»å˜é‡è¯»å–é€‰é¡¹"åŠŸèƒ½
   - DialogEventBuséœ€ç¡®ä¿å·²åœ¨UIå±‚æ³¨å†Œå›è°ƒ

3. **âš ï¸ å¤šé€‰å¯¹è¯æ¡†é™çº§**
   - éœ€è¦ç¡®è®¤DialogEventBusçš„å¤šé€‰å›è°ƒæ˜¯å¦å·²å®ç°
   - å¦‚æœªå®ç°ï¼Œä¼šé™çº§ä¸ºè¿ç»­å•é€‰

### 5.4 æœ€ç»ˆè¯„ä»·

**æ‚¨çš„é¸¿è’™å®Appå®Œå…¨æœ‰èƒ½åŠ›å®ç°"å¿«å°çº¢"è¿™æ ·çš„å¤æ‚è‡ªåŠ¨åŒ–å·¥ä½œæµï¼** ğŸ‰

**æ ¸å¿ƒè®ºæ®:**
- âœ… æ‰€æœ‰æ ¸å¿ƒä¸šåŠ¡é€»è¾‘éƒ½å¯ç”¨ç°æœ‰åŠŸèƒ½å®ç°
- âœ… æ¶æ„è®¾è®¡æ”¯æŒå¤æ‚å·¥ä½œæµ
- âœ… æ— é˜»å¡æ€§æŠ€æœ¯éšœç¢
- âœ… ä»…éœ€1-2å¤©å³å¯é…ç½®å®Œæˆ

**å»ºè®®:**
1. **ç«‹å³å®æ–½**: ä½¿ç”¨æ–¹æ¡ˆAé…ç½®å¹¶éªŒè¯åŠŸèƒ½
2. **çŸ­æœŸä¼˜åŒ–**: å¢åŠ JSON Pathå’Œæ•°ç»„å˜é‡æ”¯æŒï¼ˆ1å‘¨ï¼‰
3. **æŒç»­è¿­ä»£**: æ ¹æ®ç”¨æˆ·åé¦ˆä¼˜åŒ–ä½“éªŒ

---

## ğŸ“š é™„å½•

### A. é£ä¹¦å¤šç»´è¡¨æ ¼å­—æ®µç»“æ„

```typescript
// å­—æ®µå®šä¹‰æ¥å£
interface FieldDefinition {
  field_id: string;         // å­—æ®µID
  field_name: string;       // å­—æ®µåç§°
  type: number;             // å­—æ®µç±»å‹: 1=æ–‡æœ¬, 2=æ•°å­—, 3=å•é€‰, 4=å¤šé€‰, 5=æ—¥æœŸ, 15=URL, 17=é™„ä»¶
  is_primary: boolean;      // æ˜¯å¦ä¸ºä¸»å­—æ®µ
  property?: {
    options?: Array<{       // å•é€‰/å¤šé€‰å­—æ®µçš„é€‰é¡¹
      id: string;
      name: string;
      color: number;
    }>;
    formatter?: string;     // æ•°å­—æ ¼å¼åŒ–è§„åˆ™
    date_formatter?: string;// æ—¥æœŸæ ¼å¼åŒ–è§„åˆ™
  };
}
```

### B. MacroDroidåŠ¨ä½œç±»å‹å¯¹ç…§è¡¨

| MacroDroidåŠ¨ä½œ | åˆ†ç±» | é¸¿è’™å¯¹åº” |
|---------------|------|---------|
| LaunchActivityAction | åº”ç”¨æ§åˆ¶ | LaunchAppAction |
| ToastAction | é€šçŸ¥ | NotificationAction |
| AnimationOverlayAction | è§†è§‰æ•ˆæœ | - |
| UpdateClipboardAction | å‰ªè´´æ¿ | ClipboardAction.read() |
| SetVariableAction | å˜é‡ | SetVariableAction |
| TextManipulationAction | æ–‡æœ¬å¤„ç† | TextProcessAction |
| IfConditionAction | æµç¨‹æ§åˆ¶ | ConditionEvaluator |
| SelectionDialogAction | ç”¨æˆ·äº¤äº’ | UserDialogAction.single_select |
| MessageDialogAction | ç”¨æˆ·äº¤äº’ | UserDialogAction |
| OptionDialogAction | ç”¨æˆ·äº¤äº’ | UserDialogAction |
| HttpRequestAction | ç½‘ç»œ | HttpRequestAction |
| OpenWebPageAction | ç½‘ç»œ | OpenUrlAction |
| CancelActiveMacroAction | æµç¨‹æ§åˆ¶ | ExitMacroActionï¼ˆéœ€å®ç°ï¼‰ |
| ClearVariablesAction | å˜é‡ | SetVariableActionï¼ˆè®¾ä¸ºç©ºï¼‰ |
| JsonOutputAction | æ•°æ®è½¬æ¢ | JSON.stringifyï¼ˆéœ€å®ç°ï¼‰ |

### C. å‚è€ƒæ–‡æ¡£

- **äº§å“è¯„å®¡æŠ¥å‘Š**: `docs/äº§å“è¯„å®¡æŠ¥å‘Š-2026-01.md`
- **MacroDroidé…ç½®**: `kxh.txt`
- **é£ä¹¦APIæ–‡æ¡£**: https://open.feishu.cn/document/server-docs/docs/bitable-v1/app-table-field/list
- **é£ä¹¦æ‰£å­æ–‡æ¡£**: https://www.coze.cn/docs

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-01-08
**ä½œè€…**: Claude Code åˆ†æ
